<?php
/*
 * authgui.inc
 *
 * part of pfSense (https://www.pfsense.org)
 * Copyright (c) 2003-2006 Manuel Kasper <mk@neon1.net>
 * Copyright (c) 2005-2006 Bill Marquette <bill.marquette@gmail.com>
 * Copyright (c) 2006 Paul Taylor <paultaylor@winn-dixie.com>
 * Copyright (c) 2004-2013 BSD Perimeter
 * Copyright (c) 2013-2016 Electric Sheep Fencing
 * Copyright (c) 2014-2021 Rubicon Communications, LLC (Netgate)
 * All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

include_once("auth.inc");
include_once("priv.inc");

if (!function_exists('platform_booting')) {
    require_once('globals.inc');
}
require_once('pfsense-utils.inc');

/* Authenticate user - exit if failed */
if (!session_auth()) {
    display_login_form();
    exit;
}

phpsession_begin();

/*
 * Once here, the user has authenticated with the web server.
 * We give them access only to the appropriate pages based on
 * the user or group privileges.
 */
$allowedpages = getAllowedPages($_SESSION['Username'], $_SESSION['user_radius_attributes']);

/*
 * Get user-based preference settings so they can be easily referenced.
 */
$user_settings = get_user_settings($_SESSION['Username']);

/*
 * redirect to first allowed page if requesting a wrong url
 */

/* Fix this up otherwise the privilege check will fail. See Redmine #5909. */
if ($_SERVER['REQUEST_URI'] == "/") {
    $_SERVER['REQUEST_URI'] = "/index.php";
}

if (!isAllowedPage($_SERVER['REQUEST_URI'])) {
    if (count($allowedpages) > 0) {
        $page = str_replace('*', '', $allowedpages[0]);
        $_SESSION['Post_Login'] = true;
        require_once("functions.inc");
        pfSenseHeader("/{$page}");

        $username = get_config_user();
        log_error("{$username} attempted to access {$_SERVER['SCRIPT_NAME']} but does not have access to that page. Redirecting to {$page}.");

        exit;
    } else {
        // add this so they don't get stuck on the logout page when they have no permissions.
        $_SESSION["Logged_In"] = false;
        display_error_form("201", gettext("No page assigned to this user! Click here to logout."));

        exit;
    }
} else {
    $_SESSION['Post_Login'] = true;
}

/*
 * redirect browsers post-login to avoid pages
 * taking action in response to a POST request
 */
if (!$_SESSION['Post_Login']) {
    $_SESSION['Post_Login'] = true;
    require_once("functions.inc");
    pfSenseHeader($_SERVER['REQUEST_URI']);
    exit;
}

/*
 * Close session data to allow other scripts from same host to come in.
 * A session can be reactivated from calling phpsession_begin again
 */
phpsession_end(true);

/*

 * determine if the user is allowed access to the requested page
 */
function display_error_form($http_code, $desc) {
    global $config, $user_settings, $g;
    $vesselinfo = $config['system']['vesselinfo'];
    if (isAjax()) {
        printf(gettext('Error: %1$s Description: %2$s'), $http_code, $desc);
        return;
    }

    $logincssfile = "#770101";
    ?>

    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css" type="text/css">
        <link rel="stylesheet" href="/css/login.css?v=<?=filemtime('/usr/local/www/css/login.css')?>" type="text/css">
        <title><?=gettext("Error"); ?></title>
    </head>

    <body id="error" >
    <div id="total">
        <header>
            <div id="headerrow">
                <div class="row">
                    <div class="col-sm-4">
                        <div id="logodiv" style="text-align:center" class="nowarning">
                            <?//php include("/usr/local/www/logo.svg"); ?>
                            <svg width="171" height="39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="614" y="286" width="171" height="39"/></clipPath><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill1" gradientTransform="matrix(17.0809 0 0 -2.3083 354.39 397.227)"><stop offset="0" stop-color="#ACA6A5"/><stop offset="0.612978" stop-color="#FFFFFF"/><stop offset="1" stop-color="#FFFFFF"/></radialGradient><linearGradient x1="346.961" y1="423.652" x2="366.543" y2="398.475" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill2"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill3" gradientTransform="matrix(20.8769 0 0 -20.8769 350.484 419.786)"><stop offset="0" stop-color="#FFFFFF"/><stop offset="0.325095" stop-color="#FFFFFF"/><stop offset="1" stop-color="#BDB8B7"/></radialGradient><linearGradient x1="341.726" y1="425.426" x2="366.346" y2="400.806" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill4"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient><linearGradient x1="336.99" y1="412.933" x2="371.808" y2="412.933" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill5"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient></defs><g clip-path="url(#clip0)" transform="translate(-614 -286)"><path d="M0 0C-1.41383 0-2.67956 0.129105-3.78708 0.38605-4.89587 0.64426-5.85403 0.964491-6.66284 1.34674L-5.80467 5.52621-5.33761 5.52621C-4.57437 4.79334-3.6757 4.22503-2.64792 3.82252-1.61508 3.42129-0.50756 3.22003 0.679701 3.22003 1.89354 3.22003 2.78842 3.39344 3.35927 3.74152 3.93011 4.08833 4.2149 4.58703 4.2149 5.23382 4.2149 5.47558 4.16934 5.68569 4.07694 5.8591 3.98201 6.0363 3.8048 6.2097 3.53773 6.38184 3.27066 6.55272 2.90487 6.72233 2.44287 6.8894 1.97961 7.05775 1.37965 7.25141 0.645526 7.47038-0.162014 7.70327-0.887281 7.95769-1.52901 8.23109-2.17074 8.50449-2.71627 8.82851-3.1694 9.20317-3.62127 9.58542-3.96429 10.0259-4.19845 10.5259-4.43008 11.0246-4.54906 11.6233-4.54906 12.3169-4.54906 14.0649-3.81746 15.4597-2.35174 16.5039-0.887281 17.5444 1.11765 18.0659 3.66178 18.0659 4.88321 18.0659 6.03883 17.9608 7.12483 17.7494 8.20957 17.5393 9.13229 17.2545 9.8892 16.8951L9.0766 12.8789 8.6222 12.8789C8.04249 13.4383 7.28052 13.9054 6.33628 14.2813 5.38951 14.6585 4.3554 14.8458 3.23902 14.8458 2.1391 14.8458 1.29105 14.6787 0.689827 14.3459 0.0898673 14.0117-0.210112 13.551-0.210112 12.9611-0.210112 12.6877-0.165812 12.4624-0.0772099 12.2827 0.0113916 12.103 0.192392 11.927 0.468323 11.7549 0.705015 11.5992 1.07967 11.4296 1.59103 11.2461 2.10239 11.0625 2.70488 10.8727 3.39471 10.679 5.24648 10.155 6.57044 9.54239 7.36279 8.83991 8.15767 8.13742 8.55385 7.18432 8.55385 5.98314 8.55385 4.97688 8.33867 4.09086 7.90832 3.32509 7.47797 2.56059 6.88434 1.94037 6.12996 1.46446 5.33508 0.955631 4.43514 0.58477 3.42635 0.351875 2.41756 0.117714 1.27586 0 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 664.943 315.663)"/><path d="M0 0-4.4035 0-1.22144 5.08193-3.27826 17.9722 0.8164 17.9722 1.89734 9.36265 6.65524 17.9722 10.8879 17.9722Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 679.445 320.208)"/><path d="M0 0C0-0.234161-0.0139231-0.487309-0.043035-0.760708-0.0734127-1.03411-0.122776-1.3189-0.186063-1.61508L-2.05303-10.1753-6.10718-10.1753-4.68829-3.65292C-4.5845-3.16814-4.50349-2.75424-4.444-2.41249-4.38451-2.06948-4.35413-1.74798-4.35413-1.4518-4.35413-0.94424-4.47691-0.573379-4.7212-0.339217-4.96675-0.105056-5.41482 0.0113916-6.07047 0.0113916-6.38817 0.0113916-6.7565-0.0607554-7.1704-0.205049-7.58556-0.349343-8.05388-0.565784-8.5741-0.854372L-10.6094-10.1753-14.6357-10.1753-11.7511 2.97448-7.72226 2.97448-8.05262 1.52268C-7.22862 2.09226-6.47551 2.53654-5.79707 2.85677-5.11611 3.177-4.36806 3.33775-3.55292 3.33775-2.43148 3.33775-1.55812 3.05296-0.935379 2.48211-0.310106 1.91253 0 1.08474 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 704.296 305.085)"/><path d="M0 0C0.0227833 0.141763 0.0392378 0.270868 0.0493637 0.388581 0.0620211 0.506295 0.0658183 0.627805 0.0658183 0.753113 0.0658183 1.37206-0.116448 1.84544-0.479714 2.1758-0.845512 2.50489-1.36953 2.66944-2.05556 2.66944-2.87955 2.66944-3.57444 2.43528-4.13896 1.96442-4.69968 1.49357-5.12497 0.839183-5.41356 0ZM-3.06308-8.61714C-5.19458-8.61714-6.83751-8.12223-7.99566-7.12863-9.15381-6.13629-9.73225-4.7655-9.73225-3.01625-9.73225-1.82013-9.54365-0.722736-9.1652 0.277196-8.78548 1.27839-8.23995 2.15682-7.52734 2.91373-6.8451 3.64785-5.992 4.23009-4.96928 4.66044-3.9453 5.08953-2.82006 5.30344-1.59483 5.30344 0.268336 5.30344 1.67077 4.90726 2.61754 4.11364 3.56431 3.32003 4.0377 2.14922 4.0377 0.602491 4.0377 0.0708813 3.98707-0.449337 3.88581-0.956897 3.78582-1.46572 3.65418-1.97075 3.49343-2.47072L-5.8072-2.47072-5.8072-2.60489-5.8072-2.73905C-5.8072-3.65292-5.50342-4.36679-4.89207-4.88195-4.28199-5.3971-3.34914-5.65531-2.09353-5.65531-1.21511-5.65531-0.384784-5.49836 0.397441-5.18572 1.18473-4.87435 1.86696-4.52627 2.4454-4.14402L2.89221-4.14402 2.14542-7.52734C1.367-7.88681 0.546798-8.15894-0.313903-8.3412-1.17587-8.52474-2.091-8.61714-3.06308-8.61714" fill="#647ABB" transform="matrix(1 0 0 -1.00833 715.998 307.021)"/><path d="M0 0-0.355672 0C-0.534141 0.0620211-0.786022 0.108853-1.11005 0.139231-1.43661 0.17214-1.75811 0.186063-2.07707 0.186063-2.60362 0.186063-3.10992 0.146825-3.59849 0.0632868-4.08706-0.0177203-4.59083-0.148091-5.10725-0.327826L-7.04762-9.13356-11.0803-9.13356-8.18299 4.01492-4.15035 4.01492-4.5769 2.0834C-3.82252 2.66817-3.06815 3.14409-2.31756 3.51242-1.56318 3.87822-0.80754 4.06175-0.0443008 4.06175 0.096196 4.06175 0.251882 4.05922 0.427819 4.05036 0.601225 4.04276 0.755645 4.03137 0.888547 4.01492Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 732.094 306.135)"/><path d="M0 0C-1.41636 0-2.67703 0.129105-3.78708 0.38605-4.89587 0.64426-5.8553 0.964491-6.66284 1.34674L-5.8072 5.52621-5.34014 5.52621C-4.57437 4.79334-3.67823 4.22503-2.64792 3.82252-1.61635 3.42129-0.508826 3.22003 0.677169 3.22003 1.89354 3.22003 2.78715 3.39344 3.358 3.74152 3.92885 4.08833 4.21617 4.58703 4.21617 5.23382 4.21617 5.47558 4.16934 5.68569 4.07567 5.8591 3.98201 6.0363 3.80227 6.2097 3.5352 6.38184 3.26813 6.55272 2.90487 6.72233 2.44161 6.8894 1.97835 7.05775 1.37965 7.25141 0.645526 7.47038-0.16328 7.70327-0.888547 7.95769-1.53028 8.23109-2.17074 8.50449-2.7188 8.82851-3.17194 9.20317-3.62254 9.58542-3.96555 10.0259-4.19971 10.5259-4.43261 11.0246-4.55032 11.6233-4.55032 12.3169-4.55032 14.0649-3.81746 15.4597-2.35174 16.5039-0.888547 17.5444 1.11511 18.0659 3.65924 18.0659 4.88195 18.0659 6.03883 17.9608 7.12357 17.7494 8.20957 17.5393 9.12976 17.2545 9.8892 16.8951L9.07533 12.8789 8.62093 12.8789C8.04249 13.4383 7.27925 13.9054 6.33375 14.2813 5.38824 14.6585 4.3554 14.8458 3.23649 14.8458 2.13783 14.8458 1.29105 14.6787 0.689827 14.3459 0.0886016 14.0117-0.210112 13.551-0.210112 12.9611-0.210112 12.6877-0.167077 12.4624-0.0772099 12.2827 0.0126574 12.103 0.192392 11.927 0.467057 11.7549 0.705015 11.5992 1.08094 11.4296 1.59103 11.2461 2.10112 11.0625 2.70235 10.8727 3.39217 10.679 5.24648 10.155 6.56791 9.54239 7.36152 8.83991 8.15514 8.13742 8.55385 7.18432 8.55385 5.98314 8.55385 4.97688 8.33867 4.09086 7.90706 3.32509 7.47797 2.56059 6.88434 1.94037 6.1287 1.46446 5.33508 0.955631 4.43261 0.58477 3.42635 0.351875 2.41756 0.117714 1.27586 0 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 738.633 315.663)"/><path d="M0 0-0.675903 6.22363-4.06808 0ZM5.00346-6.68562 0.692358-6.68562 0.311371-3.12637-5.7591-3.12637-7.69568-6.68562-12.1688-6.68562-2.23529 10.7486 2.70235 10.7486Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 759.211 308.603)"/><path d="M0 0-5.15914 0-8.24501-14.0623-12.5359-14.0623-9.45379 0-14.6167 0-13.8813 3.37192 0.734127 3.37192Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 782.491 301.165)"/><path d="M340.941 397.119C340.941 394.897 351.417 394.042 359.463 394.769L359.463 394.769C364.735 395.244 367.837 396.338 367.837 397.343L367.837 397.343C367.837 398.346 364.735 399.387 359.463 399.774L359.463 399.774C357.957 399.885 356.367 399.939 354.776 399.939L354.776 399.939C347.864 399.939 340.941 398.922 340.941 397.119" fill="url(#fill1)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M340.584 413.748C340.584 405.969 346.889 399.665 354.666 399.665L354.666 399.665C362.441 399.665 368.745 405.969 368.745 413.748L368.745 413.748C368.745 421.522 362.441 427.828 354.666 427.828L354.666 427.828C346.889 427.828 340.584 421.522 340.584 413.748" fill="url(#fill2)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M342.264 413.748C342.264 406.896 347.816 401.344 354.666 401.344L354.666 401.344C361.515 401.344 367.067 406.896 367.067 413.748L367.067 413.748C367.067 420.595 361.515 426.148 354.666 426.148L354.666 426.148C347.816 426.148 342.264 420.595 342.264 413.748" fill="url(#fill3)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M0 0-1.74292 1.63913 0.043035 3.32129C0.121511 3.4023 0.121511 3.53014 0.043035 3.60988L-0.102525 3.75544-2.03784 1.93278-3.85164 3.63773C-3.93264 3.71873-4.06175 3.71873-4.14022 3.63773L-4.28452 3.49217-2.32896 1.63913-4.26427-0.197455-4.11871-0.343015C-4.04023-0.42149-3.91113-0.42149-3.83138-0.343015L-2.03404 1.34674-0.144294-0.432882 0-0.288588C0.0810072-0.207581 0.0810072-0.0797414 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 637.803 307.489)"/><path d="M0 0C-0.48984-0.578442-0.931582-1.15435-1.31637-1.68343-0.918925-1.72014-0.48984-1.82899-0.0164546-2.01885 0.102525-2.06821 0.091133-2.15935 0.0291119-2.23023L-0.122776-2.36819C-0.601225-2.16188-1.06955-2.01379-1.52268-1.97202-2.02898-2.6821-2.42642-3.28712-2.69602-3.6719-2.75171-3.74911-2.80994-3.79848-2.8631-3.79848L-2.97448-3.79594C-2.54287-3.1289-2.11251-2.4935-1.73533-1.95936L-1.76823-1.95936C-2.13783-1.95936-2.49983-2.00366-2.98334-2.18466L-2.89474-2.06062C-2.87449-1.99986-2.76943-1.86823-2.66058-1.83279-2.34668-1.72267-2.01252-1.66698-1.65432-1.66698L-1.52901-1.66824C-1.05562-1.01512-0.563253-0.365798-0.107588 0.174672L0.00632868 0.173406C0.0658183 0.16328 0.0696155 0.0797414 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 628.334 297.565)"/><path d="M0 0C-0.616414 0.218972-1.17081 0.373392-1.77456 0.410099-2.34161-0.0316434-2.8631-0.531609-3.36559-1.03284-3.46559-1.1341-3.54406-1.14676-3.59849-1.14296L-3.73772-1.13283C-3.24155-0.637931-2.59982 0-2.07075 0.415162-2.5454 0.42149-3.10992 0.343015-3.70481 0.192392L-3.60229 0.26707C-3.5352 0.321497-3.36939 0.398707-3.28459 0.424022-2.78842 0.568316-2.30238 0.629071-1.81886 0.629071L-1.79481 0.629071C-1.25814 1.02651-0.578442 1.45433 0.0405036 1.70368L0.169609 1.70621C0.255679 1.70621 0.241756 1.6733 0.117714 1.61255-0.448071 1.34042-0.991072 0.999932-1.50623 0.616414-1.00246 0.582239-0.448071 0.459462 0.153154 0.25821 0.243021 0.227833 0.24935 0.15442 0.164546 0.096196Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 632.662 295.446)"/><path d="M0 0C0.0113916-0.00506295-1.25308 1.08727-1.79735 1.51382-2.35174 0.936645-2.87449 0.374658-3.36053-0.140497-3.45546-0.243021-3.57064-0.236693-3.63266-0.178469L-3.73519-0.0784757C-3.32256 0.374658-2.68336 1.09486-2.08087 1.73533-2.57324 2.10619-3.21624 2.55173-3.71114 2.83272L-3.58963 2.99473C-3.52381 3.05929-3.41749 3.09219-3.32636 3.0403-2.8631 2.77449-2.3606 2.43907-1.80747 2.02518-1.30118 2.55805-0.560721 3.27066 0.024049 3.85164L0.165812 3.7238C0.225301 3.66431 0.24049 3.56052 0.155686 3.47698-0.407567 2.91373-0.973352 2.3644-1.51888 1.80241-1.01259 1.41256-0.469588 0.958163 0.122776 0.435413 0.22277 0.345546 0.216441 0.227833 0.153154 0.156951Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 632.653 303.167)"/><path d="M0 0C0.543001 0.470854 1.19992 1.02018 1.93025 1.52521 1.32269 1.95177 0.534141 2.41629 0.00506295 2.66817L0.137965 2.78335C0.22277 2.84538 0.378455 2.84917 0.48984 2.79348 1.05309 2.51375 1.63407 2.16694 2.23149 1.74925 2.83272 2.16694 3.56431 2.61754 4.16048 2.88208L4.32502 2.78842C4.40856 2.73526 4.42628 2.64539 4.27566 2.57198 3.72886 2.29605 3.14536 1.95177 2.53654 1.52521 3.15422 1.0936 3.75038 0.61768 4.33009 0.120245 4.43008 0.0329092 4.42628-0.0594896 4.34781-0.108853L4.18073-0.207581C3.53394 0.356938 2.87449 0.865764 2.23529 1.30118 1.59103 0.865764 0.998666 0.399973 0.434148-0.0822729 0.331623-0.17214 0.175937-0.159483 0.102525-0.096196Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 633.533 298.512)"/><path d="M0 0C0.492372 0.701218 1.01132 1.25308 1.48091 1.66318 1.92772 2.06695 2.27579 2.35174 2.82766 2.67324 3.09473 2.82766 2.93651 2.60362 2.69982 2.47958 2.31756 2.27579 1.93278 1.98847 1.50749 1.63533 1.06448 1.24042 0.593631 0.736659 0.137965 0.0974617-0.024049-0.129105-0.0860701-0.121511 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 625.454 298.121)"/><path d="M0 0C0.764505 0.230364 2.06568 0.218972 2.06568 0.218972 2.06568 0.218972 3.36306 0.230364 4.13136 0 4.31743-0.0556924 4.2668-0.184798 3.86556-0.0708813 3.0441 0.162014 2.56691 0.116448 2.06568 0.158217 1.56192 0.116448 1.08474 0.162014 0.265805-0.0708813-0.1367-0.184798-0.186063-0.0556924 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 633.699 293.282)"/><path d="M0 0C0.488574-0.579707 1.07081-1.32902 1.45433-1.8581 1.05562-1.89607 0.553127-2.02012-0.00759442-2.25934L0.0936645-2.38338C0.151888-2.46439 0.282259-2.53021 0.378455-2.4897 0.822729-2.30744 1.25561-2.18213 1.66318-2.14669 2.17074-2.85677 2.66058-3.60102 2.92765-3.97315L3.00612-3.97315C3.04536-3.97315 3.0808-3.91872 2.97701-3.7605 2.61754-3.21497 2.24921-2.66817 1.87329-2.1353L1.9062-2.13403C2.27959-2.13403 2.62261-2.19099 2.9441-2.29984 3.02131-2.32389 3.05549-2.30364 3.03397-2.24289L2.9479-2.06315C2.44287-1.86316 2.04163-1.84291 1.79481-1.84291L1.66698-1.84418C1.23536-1.23916 0.754379-0.597428 0.348078-0.130371 0.227833 0.00759442 0.14556 0 0.14556 0Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 643.06 297.389)"/><path d="M0 0C0.61768 0.218972 1.16068 0.322763 1.59103 0.348078 2.15682-0.0936645 2.79981-0.71261 3.29598-1.20878L3.43774-1.20372C3.48457-1.186 3.4871-1.12904 3.39597-1.04044 2.90107-0.544267 2.41376-0.0620211 1.88721 0.353141 2.33022 0.348078 2.75045 0.311371 3.17573 0.208847 3.44534 0.143028 3.46685 0.169609 3.4023 0.217707L3.28459 0.289854C2.87449 0.477183 2.07454 0.579707 1.63407 0.56705L1.61002 0.56705C1.07208 0.964491 0.511358 1.30751-0.0784757 1.58217-0.160749 1.62141-0.315168 1.65052-0.379721 1.64293L-0.474651 1.63533C0.112651 1.37079 0.806274 0.937911 1.32269 0.554393 0.820197 0.520218 0.220238 0.392378-0.502497 0.141763L-0.359469 0.0417693C-0.289854-0.0164546-0.148091-0.0531609 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.056 295.384)"/><path d="M0 0C0.501232 0.440476 1.03284 0.897407 1.57837 1.32396 2.13277 0.746785 2.79475 0.0443008 3.28079-0.473386L3.41243-0.373392C3.47065-0.322763 3.48457-0.225301 3.39724-0.127839 2.98334 0.325294 2.46439 0.903736 1.86443 1.5442 2.35427 1.91506 2.84917 2.26314 3.34534 2.54413 3.45926 2.60995 3.4466 2.72007 3.37699 2.80108L3.23902 2.92765C2.75171 2.65425 2.14416 2.24795 1.58977 1.83405 1.0822 2.36693 0.50756 2.91879-0.0734127 3.49976-0.186063 3.61241-0.306308 3.60229-0.373392 3.5428L-0.50756 3.42635C0.0556924 2.86436 0.682232 2.23909 1.29991 1.61255 0.746785 1.19106 0.091133 0.62654-0.501232 0.102525L-0.364532-0.0417693C-0.289854-0.115182-0.148091-0.131637 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.099 302.975)"/><path d="M0 0C0.48984 0.577176 1.06575 1.32016 1.45053 1.84924 0.951834 1.89228 0.482246 2.05049 0.00632868 2.24162L0.0772099 2.353C0.125308 2.44667 0.269602 2.52514 0.373392 2.48084 0.817666 2.29731 1.25055 2.172 1.65938 2.1353 2.16568 2.84791 2.66438 3.5871 2.93524 3.97188L3.01878 3.95922C3.05296 3.9415 3.05043 3.87189 2.97195 3.75164 2.61248 3.20485 2.24415 2.65931 1.86949 2.12517L1.90114 2.12517C2.27453 2.12517 2.61754 2.18213 2.93904 2.29098 3.02258 2.31883 3.06941 2.29605 3.00739 2.18972L2.88461 2.02012C2.49224 1.88215 2.14796 1.83152 1.78975 1.83152L1.66191 1.83405C1.25561 1.26574 0.837918 0.71261 0.402504 0.184798 0.263273 0.0164546 0.193658-0.0113916 0.124042-0.00886016Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 643.065 314.273)"/><path d="M0 0C0.501232-0.440476 1.03284-0.898673 1.57837-1.32396 2.13277-0.746785 2.79475-0.0405036 3.28079 0.477183L3.41369 0.369595C3.47065 0.318966 3.48457 0.22277 3.39724 0.126574 2.98334-0.32656 2.46439-0.905002 1.86443-1.54167 2.35427-1.91379 2.84917-2.26187 3.34534-2.5454 3.46685-2.61375 3.4466-2.72766 3.37445-2.80108L3.22889-2.92891C2.76817-2.66438 2.14416-2.24921 1.58977-1.83405 1.0822-2.36819 0.50756-2.91879-0.0734127-3.49976-0.182266-3.60988-0.298714-3.60355-0.368329-3.54786L-0.50756-3.42255C0.0556924-2.8593 0.755645-2.17327 1.29991-1.61255 0.794883-1.2227 0.091133-0.627805-0.502497-0.105056L-0.378455 0.0265805C-0.30884 0.112651-0.158217 0.139231 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.099 308.695)"/><path d="M0 0C-0.493637 0.701218-1.01386 1.25308-1.48218 1.66318-1.92772 2.06695-2.27706 2.35174-2.82766 2.67324-3.09473 2.82766-2.93398 2.60362-2.70108 2.47958-2.31883 2.27579-1.93278 1.98847-1.50749 1.63533-1.06575 1.24042-0.593631 0.736659-0.137965 0.0974617 0.0227833-0.129105 0.0835386-0.121511 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.076 298.121)"/><path d="M0 0C-0.493637-0.699952-1.01386-1.25308-1.48218-1.66318-1.92772-2.06695-2.27706-2.35174-2.82766-2.67324-3.09473-2.82766-2.93398-2.60362-2.70108-2.48084-2.31883-2.27706-1.93278-1.98974-1.50749-1.63533-1.06575-1.24169-0.593631-0.737925-0.137965-0.0987275 0.0227833 0.127839 0.0835386 0.120245 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.076 313.553)"/><path d="M0 0C0.273399-0.477183 0.544267-0.997401 0.799946-1.56572 0.565784-1.23789 0.246819-0.874624-0.0873358-0.679701L-0.0556924-0.761974C-0.0392378-0.808806 0.0848044-0.980946 0.207581-1.07841 0.469588-1.28472 0.71261-1.54673 0.929051-1.8657 1.1822-2.45426 1.41636-3.09093 1.63407-3.77569 1.66824-3.87695 1.6809-3.86936 1.65685-3.77949 1.49104-3.19725 1.29991-2.64412 1.09107-2.12264 1.29738-2.47452 1.48091-2.88588 1.64166-3.36053 1.66444-3.42888 1.67584-3.42888 1.65179-3.36053 1.45939-2.76184 1.23283-2.25048 0.968289-1.82266 0.689827-1.16068 0.378455-0.553127 0.0556924-0.00253147 0.0291119 0.0417693-0.173406 0.306308 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.597 299.065)"/><path d="M0 0C0.273399 0.477183 0.544267 0.996135 0.799946 1.56572 0.565784 1.23916 0.256945 0.879687-0.0873358 0.686029L-0.0632868 0.744253C-0.0405036 0.820197 0.117714 1.00499 0.207581 1.07588 0.469588 1.28346 0.71261 1.54546 0.929051 1.8657 1.1822 2.45426 1.41636 3.09093 1.63407 3.77316 1.66824 3.87695 1.6809 3.86936 1.65685 3.77949 1.49104 3.19725 1.29991 2.64286 1.09107 2.12264 1.29738 2.47325 1.48091 2.88461 1.64166 3.35927 1.66444 3.42761 1.67584 3.43015 1.65179 3.358 1.45939 2.76057 1.23283 2.24921 0.968289 1.82266 0.689827 1.15941 0.378455 0.551861 0.0556924 0.00126574 0.0291119-0.0443008-0.173406-0.307574 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.597 312.605)"/><path d="M0 0C-0.767036-0.229098-2.06568-0.220238-2.06568-0.220238-2.06568-0.220238-3.36686-0.229098-4.13136 0-4.31743 0.0556924-4.26806 0.183532-3.86556 0.0696155-3.04536-0.16328-2.56818-0.117714-2.06568-0.159483-1.56318-0.117714-1.08727-0.16328-0.265805 0.0696155 0.135434 0.183532 0.186063 0.0556924 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 637.83 318.391)"/><path d="M339.221 422.788C337.033 419.208 341.52 411.469 349.915 406.341L349.915 406.341C358.309 401.212 367.435 400.637 369.622 404.216L369.622 404.216C370.657 405.908 370.076 408.38 368.286 411.057L368.286 411.057C368.251 410.848 368.208 410.639 368.164 410.432L368.164 410.432C370.029 407.308 369.565 405.872 368.843 404.69L368.843 404.69C367.338 402.227 359.25 403.485 351.282 408.353L351.282 408.353C343.316 413.219 338.493 419.85 340 422.314L340 422.314C340.722 423.5 342.454 424.366 345.289 424.221L345.289 424.221C345.493 424.396 345.703 424.564 345.913 424.724L345.913 424.724C345.32 424.793 344.751 424.827 344.212 424.827L344.212 424.827C341.851 424.827 340.063 424.166 339.221 422.788" fill="url(#fill4)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M366.288 421.025C369.818 420.136 370.505 418.794 370.827 417.448L370.827 417.448C371.505 414.64 364.895 409.811 355.82 407.619L355.82 407.619C346.747 405.428 338.648 406.704 337.971 409.511L337.971 409.511C337.642 410.864 338.253 412.698 340.363 414.603L340.363 414.603C340.383 414.871 340.411 415.136 340.449 415.401L340.449 415.401C337.928 413.398 336.616 411.225 337.083 409.296L337.083 409.296C338.068 405.221 346.714 402.921 356.276 405.229L356.276 405.229C365.84 407.541 372.699 413.585 371.714 417.663L371.714 417.663C371.247 419.589 369.089 420.927 365.931 421.555L365.931 421.555C366.056 421.381 366.173 421.203 366.288 421.025" fill="url(#fill5)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/></g></svg>
                        </div>
                    </div>
                    <div class="col-sm-8 nowarning msgbox text-center">
							<span id="hostspan">
							</span>
                    </div>
                </div>
            </div>
        </header>

        <div style="background: <?=$logincssfile?>;" class="pagebody">
            <div class="col-sm-2"></div>

            <div class="col-sm-8 offset-md-4 logoCol">
                <div class="loginCont center-block error-panel">
                    <a href="index.php?logout"><?=$desc;?></a>
                </div>
            </div>

            <div class="col-sm-2"></div>
        </div>
        <footer id="3">
            <div id="footertext">
                <p class="text-muted">
                    <?=print_credit()?>
                </p>
            </div>
        </footer>

    </div>
    </body>
    </html>

    <?php

} // end function


function display_login_form() {
    require_once("globals.inc");
    global $config, $g;
    $vesselinfo = $config['system']['vesselinfo'];
    unset($input_errors);

    if (isAjax()) {
        if (isset($_POST['login'])) {
            if ($_SESSION['Logged_In'] <> "True") {
                isset($_SESSION['Login_Error']) ? $login_error = $_SESSION['Login_Error'] : $login_error = gettext("unknown reason");
                printf("showajaxmessage('" . gettext("Invalid login (%s).") . "')", $login_error);
            }
            if (file_exists("{$g['tmp_path']}/webconfigurator.lock")) {
                // TODO: add the IP from the user who did lock the device
                $whom = file_get_contents("{$g['tmp_path']}/webconfigurator.lock");
                printf("showajaxmessage('" . gettext("This device is currently being maintained by: %s.") . "');", $whom);
            }
        }
        //If session ended
        echo "SESSION_TIMEOUT";
        exit;
    }

    /* Check against locally configured IP addresses, which will catch when someone
       port forwards WebGUI access from WAN to an internal IP on the router. */
    global $FilterIflist, $nifty_background;

    $local_ip = false;

    if (strpos($_SERVER['HTTP_HOST'], ":") === FALSE) {
        $http_host_port = explode(":", $_SERVER['HTTP_HOST']);
        $http_host = $http_host_port[0];
    } else {
        $http_host = $_SERVER['HTTP_HOST'];
    }

    if (empty($FilterIflist)) {
        require_once('filter.inc');
        require_once('shaper.inc');
        filter_generate_optcfg_array();
    }

    foreach ($FilterIflist as $iflist) {
        if ($iflist['ip'] == $http_host) {
            $local_ip = true;
        } else if ($iflist['ipv6'] == $http_host) {
            $local_ip = true;
        } else if (is_array($iflist['vips'])) {
            foreach ($iflist['vips'] as $vip) {
                if ($vip['ip'] == $http_host) {
                    $local_ip = true;
                    break;
                }
            }

            unset($vip);
        }

        if ($local_ip == true) {
            break;
        }
    }

    unset($FilterIflist);
    unset($iflist);

    if ($local_ip == false) {
        if (is_array($config['openvpn']['openvpn-server'])) {
            foreach ($config['openvpn']['openvpn-server'] as $ovpns) {
                if (is_ipaddrv4($http_host) && !empty($ovpns['tunnel_network']) && ip_in_subnet($http_host, $ovpns['tunnel_network'])) {
                    $local_ip = true;
                } else if (is_ipaddrv6($http_host) && !empty($ovpns['tunnel_networkv6']) && ip_in_subnet($http_host, $ovpns['tunnel_networkv6'])) {
                    $local_ip = true;
                }

                if ($local_ip == true) {
                    break;
                }
            }
        }
    }

    // For the login form, get the settings of no particular user.
    // That ensures we will use the system default theme for the login form.
    $user_settings = get_user_settings("");
    $cssfile = "/css/pfSense.css";

    if (isset($user_settings['webgui']['webguicss'])) {
        if (file_exists("/usr/local/www/css/" . $user_settings['webgui']['webguicss'])) {
            $cssfile = "/css/" . $user_settings['webgui']['webguicss'];
        }
    }

    $logincssfile = "#1e3f75";

    if (isset($user_settings['webgui']['logincss']) && strlen($user_settings['webgui']['logincss']) == 6) {
        $logincssfile = "#" . $user_settings['webgui']['logincss'];
    }

    if (isset($config['system']['webgui']['loginshowhost'])) {
        $loginbannerstr = sprintf(gettext('%1$s.%2$s'), htmlspecialchars($config['system']['hostname']), htmlspecialchars($config['system']['domain']));
        $login_title = gettext(htmlspecialchars($config['system']['hostname'] . " - Login"));
    } else {
        $loginbannerstr = sprintf(gettext('Login to %1$s'), $g['product_label']);
        $login_title = sprintf(gettext("%s - Login"), $g['product_label']);
    }

    $loginautocomplete = isset($config['system']['webgui']['loginautocomplete']) ? '' : 'autocomplete="off"';

    if (is_ipaddr($http_host) && !$local_ip && !isset($config['system']['webgui']['nohttpreferercheck'])) {
        $warnclass = "pagebodywarn";	// Make room for a warning display row
    } else {
        $warnclass = "pagebody";
    }
    ?>
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css" type="text/css">
        <link rel="stylesheet" href="/css/login.css?v=<?=filemtime('/usr/local/www/css/login.css')?>" type="text/css">
        <title><?=$login_title; ?></title>
        <script type="text/javascript">
            //<![CDATA{
            var events = events || [];
            //]]>
        </script>
    </head>

    <body id="login" >
    <div id="total">
        <header>
            <div id="headerrow">
                <div class="row">
                    <!-- Header left logo box -->
                    <div class="col-sm-4">
                        <div id="logodiv" style="text-align:center" class="nowarning">
                            <?//php include("/usr/local/www/logo.svg"); ?>
                            <?

                            if($config['system']['vesselinfo']['logo']==="sktelink"){
                                echo '<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300px" height="107px" viewBox="0 0 637 107" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(91.764706%,0%,16.862746%);fill-opacity:1;" d="M 76 12 C 82.601562 12 89.199219 12 96 12 C 96.328125 22.558594 96.660156 33.121094 97 44 C 99.476562 40.761719 101.949219 37.523438 104.5 34.1875 C 105.722656 32.621094 105.722656 32.621094 106.96875 31.023438 C 111.421875 25.371094 111.421875 25.371094 115 19.15625 C 116.65625 15.875 118.101562 14.242188 121 12 C 123.769531 11.417969 123.769531 11.417969 126.8125 11.351562 C 128.445312 11.3125 128.445312 11.3125 130.109375 11.273438 C 135.089844 11.332031 140.039062 11.582031 145 12 C 142.429688 16.660156 139.1875 20.601562 135.8125 24.6875 C 134.640625 26.121094 133.464844 27.550781 132.292969 28.984375 C 131.726562 29.675781 131.160156 30.363281 130.574219 31.078125 C 124.9375 37.960938 119.445312 44.960938 114 52 C 114.550781 52.734375 114.550781 52.734375 115.113281 53.480469 C 117.6875 56.914062 120.261719 60.347656 122.824219 63.789062 C 128.6875 71.648438 134.636719 79.425781 140.722656 87.109375 C 141.851562 88.539062 141.851562 88.539062 143 90 C 143.597656 90.746094 144.195312 91.496094 144.808594 92.265625 C 146 94 146 94 146 96 C 125.25 98.839844 125.25 98.839844 118.71875 94.476562 C 114.757812 90.367188 112.070312 85.480469 109.394531 80.476562 C 107.167969 76.519531 104.433594 72.980469 101.6875 69.375 C 100.773438 68.132812 99.859375 66.890625 98.949219 65.648438 C 98.304688 64.773438 97.664062 63.902344 97 63 C 96.984375 63.636719 96.972656 64.269531 96.957031 64.925781 C 96.882812 67.824219 96.785156 70.726562 96.6875 73.625 C 96.664062 74.625 96.640625 75.625 96.617188 76.652344 C 96.390625 82.929688 95.914062 87.804688 91.5 92.644531 C 85.75 97.121094 83.835938 97 76 97 C 76 68.949219 76 40.898438 76 12 Z M 76 12 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 268.335938 41.734375 C 270.332031 43.253906 271.046875 44.707031 272 47 C 272.890625 46.507812 273.785156 46.011719 274.703125 45.503906 C 275.886719 44.855469 277.066406 44.210938 278.25 43.5625 C 278.835938 43.238281 279.421875 42.910156 280.027344 42.578125 C 286.300781 39.15625 292.035156 37.921875 299.121094 39.460938 C 305.128906 41.390625 308.070312 44.492188 311.121094 50.035156 C 312.453125 54.523438 312.246094 58.894531 312.195312 63.550781 C 312.191406 64.566406 312.191406 65.578125 312.1875 66.625 C 312.175781 69.851562 312.152344 73.082031 312.125 76.3125 C 312.113281 78.503906 312.105469 80.699219 312.097656 82.890625 C 312.074219 88.261719 312.042969 93.632812 312 99 C 307.050781 99 302.101562 99 297 99 C 296.976562 97.777344 296.949219 96.558594 296.925781 95.300781 C 296.828125 90.765625 296.730469 86.234375 296.628906 81.703125 C 296.585938 79.742188 296.542969 77.78125 296.503906 75.820312 C 296.445312 73 296.382812 70.179688 296.316406 67.359375 C 296.300781 66.484375 296.28125 65.605469 296.265625 64.703125 C 296.234375 63.472656 296.234375 63.472656 296.207031 62.21875 C 296.191406 61.5 296.175781 60.777344 296.160156 60.039062 C 295.996094 57.929688 295.570312 56.03125 295 54 C 293.3125 53.890625 291.625 53.8125 289.9375 53.75 C 288.527344 53.679688 288.527344 53.679688 287.089844 53.609375 C 283.097656 54.113281 279.90625 55.199219 277 58 C 275.960938 61.105469 276.042969 64.105469 276.097656 67.359375 C 276.085938 68.265625 276.074219 69.167969 276.058594 70.101562 C 276.027344 72.984375 276.046875 75.867188 276.0625 78.75 C 276.050781 80.707031 276.03125 82.664062 276.015625 84.621094 C 275.972656 89.414062 275.976562 94.207031 276 99 C 271.050781 99 266.101562 99 261 99 C 260.976562 97.816406 260.949219 96.628906 260.925781 95.40625 C 260.828125 91 260.730469 86.59375 260.628906 82.183594 C 260.585938 80.277344 260.542969 78.371094 260.503906 76.46875 C 260.445312 73.722656 260.382812 70.980469 260.316406 68.238281 C 260.300781 67.390625 260.28125 66.539062 260.265625 65.664062 C 260.167969 61.664062 259.976562 57.90625 259 54 C 257.3125 53.890625 255.625 53.8125 253.9375 53.75 C 252.527344 53.679688 252.527344 53.679688 251.089844 53.609375 C 247.097656 54.113281 243.90625 55.199219 241 58 C 239.960938 61.105469 240.042969 64.105469 240.097656 67.359375 C 240.078125 68.714844 240.078125 68.714844 240.058594 70.101562 C 240.027344 72.984375 240.046875 75.867188 240.0625 78.75 C 240.050781 80.707031 240.03125 82.664062 240.015625 84.621094 C 239.972656 89.414062 239.976562 94.207031 240 99 C 235.050781 99 230.101562 99 225 99 C 225 79.859375 225 60.71875 225 41 C 229.289062 41 233.578125 41 238 41 C 238.328125 42.648438 238.660156 44.300781 239 46 C 239.746094 45.492188 239.746094 45.492188 240.503906 44.976562 C 249.632812 38.984375 258.339844 36.714844 268.335938 41.734375 Z M 268.335938 41.734375 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(91.37255%,0%,16.862746%);fill-opacity:1;" d="M 59 13 C 60.867188 14.605469 60.867188 14.605469 62 16 C 61.453125 17.257812 60.886719 18.503906 60.3125 19.75 C 60 20.445312 59.6875 21.140625 59.363281 21.859375 C 57.527344 24.742188 55.949219 26.226562 53 28 C 50.121094 28.394531 47.332031 28.242188 44.4375 28.0625 C 38.738281 27.601562 38.738281 27.601562 33.472656 29.496094 C 31.648438 31.023438 31.648438 31.023438 31.875 34.125 C 32.277344 36.851562 32.742188 37.78125 34.871094 39.589844 C 38.496094 41.777344 42.21875 43.636719 46.050781 45.425781 C 54.277344 49.304688 60.117188 53.40625 65 61.1875 C 67.246094 69.75 67.171875 78 62.671875 85.777344 C 57.46875 92.695312 50.519531 96.738281 42 98 C 29.042969 98.953125 17.46875 97.398438 6 91 C 7.425781 87.210938 9.164062 83.730469 11.125 80.1875 C 11.664062 79.210938 12.203125 78.234375 12.757812 77.230469 C 13.167969 76.496094 13.578125 75.757812 14 75 C 14.738281 75.296875 15.480469 75.59375 16.242188 75.898438 C 17.152344 76.261719 18.0625 76.625 19 77 C 19.683594 77.28125 20.367188 77.5625 21.070312 77.851562 C 27.464844 80.257812 34.660156 81.550781 41.261719 79.191406 C 43.382812 78.003906 43.382812 78.003906 44 74.625 C 44.355469 71.097656 44.355469 71.097656 42.613281 69.105469 C 38.046875 65.425781 32.734375 62.988281 27.53125 60.328125 C 19.984375 56.339844 13.0625 51.671875 10.4375 43.160156 C 8.824219 35.195312 9.832031 28.027344 14 21 C 24.96875 7.503906 43.761719 7.601562 59 13 Z M 59 13 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 431 23 C 431 28.941406 431 34.878906 431 41 C 436.609375 41 442.21875 41 448 41 C 446.125 50.75 446.125 50.75 445 53 C 440.378906 53 435.761719 53 431 53 C 431.121094 57.21875 431.242188 61.433594 431.371094 65.652344 C 431.414062 67.085938 431.457031 68.523438 431.496094 69.957031 C 431.554688 72.019531 431.617188 74.082031 431.683594 76.144531 C 431.738281 78.007812 431.738281 78.007812 431.792969 79.90625 C 431.871094 83.035156 431.871094 83.035156 433 86 C 437.515625 86.078125 441.589844 86.101562 446 85 C 446.671875 86.457031 447.335938 87.914062 448 89.375 C 448.558594 90.59375 448.558594 90.59375 449.125 91.835938 C 450 94 450 94 450 96 C 441.90625 99.507812 434.421875 101.722656 425.671875 99.375 C 420.882812 97.386719 418.945312 94.8125 416.792969 90.214844 C 415.515625 86.640625 415.503906 83.324219 415.609375 79.5625 C 415.613281 78.796875 415.621094 78.03125 415.625 77.242188 C 415.648438 74.828125 415.699219 72.414062 415.75 70 C 415.769531 68.351562 415.789062 66.699219 415.804688 65.050781 C 415.847656 61.035156 415.917969 57.015625 416 53 C 414.667969 53.113281 414.667969 53.113281 413.3125 53.226562 C 411.5625 53.367188 411.5625 53.367188 409.777344 53.511719 C 408.621094 53.605469 407.46875 53.703125 406.277344 53.800781 C 403.652344 53.960938 401.179688 53.957031 398.5625 53.8125 C 394.035156 54.050781 392.351562 54.949219 389 58 C 388.105469 61.109375 388.160156 64.140625 388.195312 67.359375 C 388.179688 68.265625 388.167969 69.167969 388.152344 70.101562 C 388.117188 72.984375 388.121094 75.867188 388.125 78.75 C 388.105469 80.707031 388.085938 82.664062 388.0625 84.621094 C 388.011719 89.414062 387.996094 94.207031 388 99 C 383.050781 99 378.101562 99 373 99 C 373 79.859375 373 60.71875 373 41 C 377.289062 41 381.578125 41 386 41 C 386.660156 42.320312 387.320312 43.640625 388 45 C 388.542969 44.652344 389.085938 44.300781 389.644531 43.941406 C 390.359375 43.488281 391.074219 43.03125 391.8125 42.5625 C 392.519531 42.109375 393.226562 41.65625 393.957031 41.191406 C 400.96875 37.101562 408.554688 39.367188 416 41 C 416 36.378906 416 31.761719 416 27 C 428.75 23 428.75 23 431 23 Z M 431 23 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 211 14 C 211 18.949219 211 23.898438 211 29 C 207.523438 28.304688 204.609375 27.566406 201.3125 26.4375 C 195.0625 24.542969 189.183594 23.894531 182.9375 26.0625 C 180.75 27.980469 180.75 27.980469 179.8125 31.25 C 180.070312 36.410156 182.285156 38.574219 186 42 C 188.675781 43.765625 191.476562 45.132812 194.375 46.5 C 203.617188 51.144531 211.535156 55.703125 215 66 C 216.914062 73.144531 215.726562 79.792969 212.25 86.25 C 206.023438 93.859375 199.011719 97.390625 189.1875 98.386719 C 177.964844 98.875 167.949219 97.160156 159 90 C 160.980469 86.039062 162.960938 82.078125 165 78 C 167.878906 79.152344 170.742188 80.339844 173.5625 81.625 C 180.09375 84.054688 187.226562 84.082031 193.6875 81.5625 C 195.867188 80.195312 195.867188 80.195312 197 79 C 197.644531 73.195312 197.644531 73.195312 195.089844 68.0625 C 191.53125 64.066406 186.90625 62.042969 182.1875 59.6875 C 173.5625 55.164062 166.96875 50.9375 162.5 42 C 161.152344 33.90625 161.78125 27.210938 166 20 C 176.492188 7.113281 196.90625 6.953125 211 14 Z M 211 14 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 520 14 C 520 18.949219 520 23.898438 520 29 C 517.527344 28.25 515.050781 27.503906 512.578125 26.753906 C 511.726562 26.503906 510.875 26.257812 510 26 C 509.34375 25.804688 508.691406 25.613281 508.015625 25.414062 C 505.484375 24.894531 503.085938 24.832031 500.5 24.8125 C 499.5625 24.796875 498.625 24.785156 497.65625 24.769531 C 494.90625 25.007812 493.304688 25.507812 491 27 C 489.449219 30.101562 489.710938 32.578125 490 36 C 493.222656 41.503906 498.460938 43.691406 503.9375 46.5 C 509.722656 49.480469 514.699219 52.054688 519 57 C 519.722656 57.804688 520.445312 58.609375 521.1875 59.4375 C 525.277344 65.21875 525.660156 71.121094 525 78 C 523.710938 84.523438 520.261719 89.023438 515 93 C 504.492188 98.847656 492.628906 99.71875 481 96.75 C 476.59375 95.375 472.875 93.496094 469 91 C 470.414062 86.171875 472.429688 82.285156 475 78 C 475.8125 78.359375 476.621094 78.722656 477.457031 79.09375 C 486.078125 82.707031 493.523438 85.019531 502.5625 81.6875 C 505.21875 80.070312 505.21875 80.070312 507 77 C 506.925781 72.996094 506.609375 70.738281 504.035156 67.621094 C 500.355469 64.140625 495.90625 61.871094 491.5 59.4375 C 475.101562 50.308594 475.101562 50.308594 472 41 C 471.160156 32.828125 471.238281 26.023438 476.019531 19.128906 C 487.023438 7.300781 506.121094 7.058594 520 14 Z M 520 14 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 575 39 C 581.171875 45.515625 581.316406 52.335938 581.414062 60.867188 C 581.433594 61.902344 581.453125 62.9375 581.472656 64.003906 C 581.53125 67.292969 581.578125 70.585938 581.625 73.875 C 581.664062 76.113281 581.703125 78.347656 581.742188 80.585938 C 581.839844 86.058594 581.921875 91.527344 582 97 C 577.378906 97 572.761719 97 568 97 C 567.671875 95.351562 567.339844 93.699219 567 92 C 566.261719 92.433594 565.523438 92.867188 564.761719 93.3125 C 557.707031 97.183594 552.070312 99.429688 544 98 C 537.789062 96.160156 533.574219 92.332031 530 87 C 528.027344 81.085938 528.003906 74.367188 530.5625 68.625 C 533.476562 63.601562 537.652344 61.019531 542.875 58.75 C 550.207031 56.988281 557.488281 56.859375 565 57 C 564.574219 55.703125 564.132812 54.414062 563.6875 53.125 C 563.445312 52.40625 563.199219 51.6875 562.949219 50.945312 C 562.035156 48.660156 562.035156 48.660156 559 47 C 551.304688 46 544.285156 47.632812 537 50 C 536.296875 48.757812 535.613281 47.507812 534.9375 46.25 C 534.554688 45.554688 534.171875 44.859375 533.777344 44.140625 C 533 42 533 42 533.054688 39.871094 C 534.472656 37.066406 536.257812 36.78125 539.1875 35.8125 C 551.222656 31.867188 564.53125 30.675781 575 39 Z M 546 72 C 544.820312 75.984375 544.574219 78.066406 546.3125 81.875 C 547.828125 84.089844 547.828125 84.089844 550 85 C 556.242188 85.625 559.695312 83.980469 565 81 C 565 76.710938 565 72.421875 565 68 C 554.785156 67.679688 554.785156 67.679688 546 72 Z M 546 72 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 357 42 C 361.4375 45.722656 364.640625 50.304688 365.214844 56.1875 C 365.328125 58.902344 365.382812 61.613281 365.414062 64.332031 C 365.433594 65.324219 365.453125 66.316406 365.472656 67.335938 C 365.53125 70.496094 365.578125 73.652344 365.625 76.8125 C 365.664062 78.957031 365.703125 81.101562 365.742188 83.25 C 365.839844 88.5 365.921875 93.75 366 99 C 361.710938 99 357.421875 99 353 99 C 352.339844 97.679688 351.679688 96.359375 351 95 C 349.925781 95.640625 348.855469 96.277344 347.75 96.9375 C 342.375 100.140625 337.167969 100.574219 331 100 C 324.335938 97.890625 320.496094 94.78125 317.1875 88.625 C 315.25 82.707031 315.472656 77.644531 317.828125 71.925781 C 320.695312 67.214844 325.160156 64.65625 330.238281 62.84375 C 334.429688 61.902344 338.171875 61.773438 342.4375 61.875 C 343.535156 61.886719 343.535156 61.886719 344.65625 61.902344 C 346.4375 61.925781 348.21875 61.960938 350 62 C 348.898438 56.992188 348.898438 56.992188 345.875 53.0625 C 338.328125 50.273438 331.375 52.722656 324 55 C 323.324219 53.734375 322.660156 52.460938 322 51.1875 C 321.441406 50.125 321.441406 50.125 320.875 49.042969 C 320 47 320 47 320 44 C 321.726562 43.347656 323.457031 42.703125 325.1875 42.0625 C 326.152344 41.703125 327.113281 41.34375 328.105469 40.972656 C 337.359375 37.863281 348.109375 37.5625 357 42 Z M 332 76 C 331.460938 81.199219 331.460938 81.199219 333.125 85.9375 C 336.480469 87.839844 339.355469 88.445312 343.132812 87.421875 C 346.851562 86.195312 346.851562 86.195312 350 84 C 350.074219 81.980469 350.082031 79.957031 350.0625 77.9375 C 350.054688 76.832031 350.042969 75.726562 350.035156 74.589844 C 350.023438 73.734375 350.011719 72.878906 350 72 C 340.230469 71.492188 340.230469 71.492188 332 76 Z M 332 76 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,47.450981%,0%);fill-opacity:1;" d="M 610 16 C 610 22.269531 610 28.539062 610 35 C 615.941406 35 621.878906 35 628 35 C 626.125 44.625 626.125 44.625 625 48 C 620.050781 48 615.101562 48 610 48 C 610.121094 52.503906 610.242188 57.003906 610.371094 61.507812 C 610.414062 63.039062 610.457031 64.570312 610.496094 66.101562 C 610.554688 68.304688 610.617188 70.503906 610.683594 72.707031 C 610.699219 73.390625 610.71875 74.074219 610.734375 74.78125 C 610.828125 77.769531 611.046875 80.140625 612 83 C 616.484375 84.042969 618.839844 83.910156 623 82 C 623.988281 82 624.980469 82 626 82 C 627.320312 85.628906 628.640625 89.261719 630 93 C 622.808594 98.394531 615.800781 98.753906 607 98 C 601.308594 96.769531 598.21875 93.640625 595 89 C 593.683594 84.898438 593.875 80.78125 593.902344 76.515625 C 593.902344 75.699219 593.90625 74.882812 593.90625 74.042969 C 593.914062 71.445312 593.925781 68.847656 593.9375 66.25 C 593.941406 64.484375 593.945312 62.722656 593.953125 60.957031 C 593.960938 56.636719 593.980469 52.320312 594 48 C 590.371094 48 586.738281 48 583 48 C 583 43.710938 583 39.421875 583 35 C 586.628906 35 590.261719 35 594 35 C 594 30.378906 594 25.761719 594 21 C 607.183594 16 607.183594 16 610 16 Z M 610 16 "/>
</g>
</svg>
';
                            }
                            else {
                                echo '<svg width="171" height="39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="614" y="286" width="171" height="39"/></clipPath><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill1" gradientTransform="matrix(17.0809 0 0 -2.3083 354.39 397.227)"><stop offset="0" stop-color="#ACA6A5"/><stop offset="0.612978" stop-color="#FFFFFF"/><stop offset="1" stop-color="#FFFFFF"/></radialGradient><linearGradient x1="346.961" y1="423.652" x2="366.543" y2="398.475" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill2"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient><radialGradient cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill3" gradientTransform="matrix(20.8769 0 0 -20.8769 350.484 419.786)"><stop offset="0" stop-color="#FFFFFF"/><stop offset="0.325095" stop-color="#FFFFFF"/><stop offset="1" stop-color="#BDB8B7"/></radialGradient><linearGradient x1="341.726" y1="425.426" x2="366.346" y2="400.806" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill4"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient><linearGradient x1="336.99" y1="412.933" x2="371.808" y2="412.933" gradientUnits="userSpaceOnUse" spreadMethod="pad" id="fill5"><stop offset="0" stop-color="#93D9F8"/><stop offset="0.527466" stop-color="#6B86C2"/><stop offset="1" stop-color="#69489A"/></linearGradient></defs><g clip-path="url(#clip0)" transform="translate(-614 -286)"><path d="M0 0C-1.41383 0-2.67956 0.129105-3.78708 0.38605-4.89587 0.64426-5.85403 0.964491-6.66284 1.34674L-5.80467 5.52621-5.33761 5.52621C-4.57437 4.79334-3.6757 4.22503-2.64792 3.82252-1.61508 3.42129-0.50756 3.22003 0.679701 3.22003 1.89354 3.22003 2.78842 3.39344 3.35927 3.74152 3.93011 4.08833 4.2149 4.58703 4.2149 5.23382 4.2149 5.47558 4.16934 5.68569 4.07694 5.8591 3.98201 6.0363 3.8048 6.2097 3.53773 6.38184 3.27066 6.55272 2.90487 6.72233 2.44287 6.8894 1.97961 7.05775 1.37965 7.25141 0.645526 7.47038-0.162014 7.70327-0.887281 7.95769-1.52901 8.23109-2.17074 8.50449-2.71627 8.82851-3.1694 9.20317-3.62127 9.58542-3.96429 10.0259-4.19845 10.5259-4.43008 11.0246-4.54906 11.6233-4.54906 12.3169-4.54906 14.0649-3.81746 15.4597-2.35174 16.5039-0.887281 17.5444 1.11765 18.0659 3.66178 18.0659 4.88321 18.0659 6.03883 17.9608 7.12483 17.7494 8.20957 17.5393 9.13229 17.2545 9.8892 16.8951L9.0766 12.8789 8.6222 12.8789C8.04249 13.4383 7.28052 13.9054 6.33628 14.2813 5.38951 14.6585 4.3554 14.8458 3.23902 14.8458 2.1391 14.8458 1.29105 14.6787 0.689827 14.3459 0.0898673 14.0117-0.210112 13.551-0.210112 12.9611-0.210112 12.6877-0.165812 12.4624-0.0772099 12.2827 0.0113916 12.103 0.192392 11.927 0.468323 11.7549 0.705015 11.5992 1.07967 11.4296 1.59103 11.2461 2.10239 11.0625 2.70488 10.8727 3.39471 10.679 5.24648 10.155 6.57044 9.54239 7.36279 8.83991 8.15767 8.13742 8.55385 7.18432 8.55385 5.98314 8.55385 4.97688 8.33867 4.09086 7.90832 3.32509 7.47797 2.56059 6.88434 1.94037 6.12996 1.46446 5.33508 0.955631 4.43514 0.58477 3.42635 0.351875 2.41756 0.117714 1.27586 0 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 664.943 315.663)"/><path d="M0 0-4.4035 0-1.22144 5.08193-3.27826 17.9722 0.8164 17.9722 1.89734 9.36265 6.65524 17.9722 10.8879 17.9722Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 679.445 320.208)"/><path d="M0 0C0-0.234161-0.0139231-0.487309-0.043035-0.760708-0.0734127-1.03411-0.122776-1.3189-0.186063-1.61508L-2.05303-10.1753-6.10718-10.1753-4.68829-3.65292C-4.5845-3.16814-4.50349-2.75424-4.444-2.41249-4.38451-2.06948-4.35413-1.74798-4.35413-1.4518-4.35413-0.94424-4.47691-0.573379-4.7212-0.339217-4.96675-0.105056-5.41482 0.0113916-6.07047 0.0113916-6.38817 0.0113916-6.7565-0.0607554-7.1704-0.205049-7.58556-0.349343-8.05388-0.565784-8.5741-0.854372L-10.6094-10.1753-14.6357-10.1753-11.7511 2.97448-7.72226 2.97448-8.05262 1.52268C-7.22862 2.09226-6.47551 2.53654-5.79707 2.85677-5.11611 3.177-4.36806 3.33775-3.55292 3.33775-2.43148 3.33775-1.55812 3.05296-0.935379 2.48211-0.310106 1.91253 0 1.08474 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 704.296 305.085)"/><path d="M0 0C0.0227833 0.141763 0.0392378 0.270868 0.0493637 0.388581 0.0620211 0.506295 0.0658183 0.627805 0.0658183 0.753113 0.0658183 1.37206-0.116448 1.84544-0.479714 2.1758-0.845512 2.50489-1.36953 2.66944-2.05556 2.66944-2.87955 2.66944-3.57444 2.43528-4.13896 1.96442-4.69968 1.49357-5.12497 0.839183-5.41356 0ZM-3.06308-8.61714C-5.19458-8.61714-6.83751-8.12223-7.99566-7.12863-9.15381-6.13629-9.73225-4.7655-9.73225-3.01625-9.73225-1.82013-9.54365-0.722736-9.1652 0.277196-8.78548 1.27839-8.23995 2.15682-7.52734 2.91373-6.8451 3.64785-5.992 4.23009-4.96928 4.66044-3.9453 5.08953-2.82006 5.30344-1.59483 5.30344 0.268336 5.30344 1.67077 4.90726 2.61754 4.11364 3.56431 3.32003 4.0377 2.14922 4.0377 0.602491 4.0377 0.0708813 3.98707-0.449337 3.88581-0.956897 3.78582-1.46572 3.65418-1.97075 3.49343-2.47072L-5.8072-2.47072-5.8072-2.60489-5.8072-2.73905C-5.8072-3.65292-5.50342-4.36679-4.89207-4.88195-4.28199-5.3971-3.34914-5.65531-2.09353-5.65531-1.21511-5.65531-0.384784-5.49836 0.397441-5.18572 1.18473-4.87435 1.86696-4.52627 2.4454-4.14402L2.89221-4.14402 2.14542-7.52734C1.367-7.88681 0.546798-8.15894-0.313903-8.3412-1.17587-8.52474-2.091-8.61714-3.06308-8.61714" fill="#647ABB" transform="matrix(1 0 0 -1.00833 715.998 307.021)"/><path d="M0 0-0.355672 0C-0.534141 0.0620211-0.786022 0.108853-1.11005 0.139231-1.43661 0.17214-1.75811 0.186063-2.07707 0.186063-2.60362 0.186063-3.10992 0.146825-3.59849 0.0632868-4.08706-0.0177203-4.59083-0.148091-5.10725-0.327826L-7.04762-9.13356-11.0803-9.13356-8.18299 4.01492-4.15035 4.01492-4.5769 2.0834C-3.82252 2.66817-3.06815 3.14409-2.31756 3.51242-1.56318 3.87822-0.80754 4.06175-0.0443008 4.06175 0.096196 4.06175 0.251882 4.05922 0.427819 4.05036 0.601225 4.04276 0.755645 4.03137 0.888547 4.01492Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 732.094 306.135)"/><path d="M0 0C-1.41636 0-2.67703 0.129105-3.78708 0.38605-4.89587 0.64426-5.8553 0.964491-6.66284 1.34674L-5.8072 5.52621-5.34014 5.52621C-4.57437 4.79334-3.67823 4.22503-2.64792 3.82252-1.61635 3.42129-0.508826 3.22003 0.677169 3.22003 1.89354 3.22003 2.78715 3.39344 3.358 3.74152 3.92885 4.08833 4.21617 4.58703 4.21617 5.23382 4.21617 5.47558 4.16934 5.68569 4.07567 5.8591 3.98201 6.0363 3.80227 6.2097 3.5352 6.38184 3.26813 6.55272 2.90487 6.72233 2.44161 6.8894 1.97835 7.05775 1.37965 7.25141 0.645526 7.47038-0.16328 7.70327-0.888547 7.95769-1.53028 8.23109-2.17074 8.50449-2.7188 8.82851-3.17194 9.20317-3.62254 9.58542-3.96555 10.0259-4.19971 10.5259-4.43261 11.0246-4.55032 11.6233-4.55032 12.3169-4.55032 14.0649-3.81746 15.4597-2.35174 16.5039-0.888547 17.5444 1.11511 18.0659 3.65924 18.0659 4.88195 18.0659 6.03883 17.9608 7.12357 17.7494 8.20957 17.5393 9.12976 17.2545 9.8892 16.8951L9.07533 12.8789 8.62093 12.8789C8.04249 13.4383 7.27925 13.9054 6.33375 14.2813 5.38824 14.6585 4.3554 14.8458 3.23649 14.8458 2.13783 14.8458 1.29105 14.6787 0.689827 14.3459 0.0886016 14.0117-0.210112 13.551-0.210112 12.9611-0.210112 12.6877-0.167077 12.4624-0.0772099 12.2827 0.0126574 12.103 0.192392 11.927 0.467057 11.7549 0.705015 11.5992 1.08094 11.4296 1.59103 11.2461 2.10112 11.0625 2.70235 10.8727 3.39217 10.679 5.24648 10.155 6.56791 9.54239 7.36152 8.83991 8.15514 8.13742 8.55385 7.18432 8.55385 5.98314 8.55385 4.97688 8.33867 4.09086 7.90706 3.32509 7.47797 2.56059 6.88434 1.94037 6.1287 1.46446 5.33508 0.955631 4.43261 0.58477 3.42635 0.351875 2.41756 0.117714 1.27586 0 0 0" fill="#647ABB" transform="matrix(1 0 0 -1.00833 738.633 315.663)"/><path d="M0 0-0.675903 6.22363-4.06808 0ZM5.00346-6.68562 0.692358-6.68562 0.311371-3.12637-5.7591-3.12637-7.69568-6.68562-12.1688-6.68562-2.23529 10.7486 2.70235 10.7486Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 759.211 308.603)"/><path d="M0 0-5.15914 0-8.24501-14.0623-12.5359-14.0623-9.45379 0-14.6167 0-13.8813 3.37192 0.734127 3.37192Z" fill="#647ABB" transform="matrix(1 0 0 -1.00833 782.491 301.165)"/><path d="M340.941 397.119C340.941 394.897 351.417 394.042 359.463 394.769L359.463 394.769C364.735 395.244 367.837 396.338 367.837 397.343L367.837 397.343C367.837 398.346 364.735 399.387 359.463 399.774L359.463 399.774C357.957 399.885 356.367 399.939 354.776 399.939L354.776 399.939C347.864 399.939 340.941 398.922 340.941 397.119" fill="url(#fill1)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M340.584 413.748C340.584 405.969 346.889 399.665 354.666 399.665L354.666 399.665C362.441 399.665 368.745 405.969 368.745 413.748L368.745 413.748C368.745 421.522 362.441 427.828 354.666 427.828L354.666 427.828C346.889 427.828 340.584 421.522 340.584 413.748" fill="url(#fill2)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M342.264 413.748C342.264 406.896 347.816 401.344 354.666 401.344L354.666 401.344C361.515 401.344 367.067 406.896 367.067 413.748L367.067 413.748C367.067 420.595 361.515 426.148 354.666 426.148L354.666 426.148C347.816 426.148 342.264 420.595 342.264 413.748" fill="url(#fill3)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M0 0-1.74292 1.63913 0.043035 3.32129C0.121511 3.4023 0.121511 3.53014 0.043035 3.60988L-0.102525 3.75544-2.03784 1.93278-3.85164 3.63773C-3.93264 3.71873-4.06175 3.71873-4.14022 3.63773L-4.28452 3.49217-2.32896 1.63913-4.26427-0.197455-4.11871-0.343015C-4.04023-0.42149-3.91113-0.42149-3.83138-0.343015L-2.03404 1.34674-0.144294-0.432882 0-0.288588C0.0810072-0.207581 0.0810072-0.0797414 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 637.803 307.489)"/><path d="M0 0C-0.48984-0.578442-0.931582-1.15435-1.31637-1.68343-0.918925-1.72014-0.48984-1.82899-0.0164546-2.01885 0.102525-2.06821 0.091133-2.15935 0.0291119-2.23023L-0.122776-2.36819C-0.601225-2.16188-1.06955-2.01379-1.52268-1.97202-2.02898-2.6821-2.42642-3.28712-2.69602-3.6719-2.75171-3.74911-2.80994-3.79848-2.8631-3.79848L-2.97448-3.79594C-2.54287-3.1289-2.11251-2.4935-1.73533-1.95936L-1.76823-1.95936C-2.13783-1.95936-2.49983-2.00366-2.98334-2.18466L-2.89474-2.06062C-2.87449-1.99986-2.76943-1.86823-2.66058-1.83279-2.34668-1.72267-2.01252-1.66698-1.65432-1.66698L-1.52901-1.66824C-1.05562-1.01512-0.563253-0.365798-0.107588 0.174672L0.00632868 0.173406C0.0658183 0.16328 0.0696155 0.0797414 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 628.334 297.565)"/><path d="M0 0C-0.616414 0.218972-1.17081 0.373392-1.77456 0.410099-2.34161-0.0316434-2.8631-0.531609-3.36559-1.03284-3.46559-1.1341-3.54406-1.14676-3.59849-1.14296L-3.73772-1.13283C-3.24155-0.637931-2.59982 0-2.07075 0.415162-2.5454 0.42149-3.10992 0.343015-3.70481 0.192392L-3.60229 0.26707C-3.5352 0.321497-3.36939 0.398707-3.28459 0.424022-2.78842 0.568316-2.30238 0.629071-1.81886 0.629071L-1.79481 0.629071C-1.25814 1.02651-0.578442 1.45433 0.0405036 1.70368L0.169609 1.70621C0.255679 1.70621 0.241756 1.6733 0.117714 1.61255-0.448071 1.34042-0.991072 0.999932-1.50623 0.616414-1.00246 0.582239-0.448071 0.459462 0.153154 0.25821 0.243021 0.227833 0.24935 0.15442 0.164546 0.096196Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 632.662 295.446)"/><path d="M0 0C0.0113916-0.00506295-1.25308 1.08727-1.79735 1.51382-2.35174 0.936645-2.87449 0.374658-3.36053-0.140497-3.45546-0.243021-3.57064-0.236693-3.63266-0.178469L-3.73519-0.0784757C-3.32256 0.374658-2.68336 1.09486-2.08087 1.73533-2.57324 2.10619-3.21624 2.55173-3.71114 2.83272L-3.58963 2.99473C-3.52381 3.05929-3.41749 3.09219-3.32636 3.0403-2.8631 2.77449-2.3606 2.43907-1.80747 2.02518-1.30118 2.55805-0.560721 3.27066 0.024049 3.85164L0.165812 3.7238C0.225301 3.66431 0.24049 3.56052 0.155686 3.47698-0.407567 2.91373-0.973352 2.3644-1.51888 1.80241-1.01259 1.41256-0.469588 0.958163 0.122776 0.435413 0.22277 0.345546 0.216441 0.227833 0.153154 0.156951Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 632.653 303.167)"/><path d="M0 0C0.543001 0.470854 1.19992 1.02018 1.93025 1.52521 1.32269 1.95177 0.534141 2.41629 0.00506295 2.66817L0.137965 2.78335C0.22277 2.84538 0.378455 2.84917 0.48984 2.79348 1.05309 2.51375 1.63407 2.16694 2.23149 1.74925 2.83272 2.16694 3.56431 2.61754 4.16048 2.88208L4.32502 2.78842C4.40856 2.73526 4.42628 2.64539 4.27566 2.57198 3.72886 2.29605 3.14536 1.95177 2.53654 1.52521 3.15422 1.0936 3.75038 0.61768 4.33009 0.120245 4.43008 0.0329092 4.42628-0.0594896 4.34781-0.108853L4.18073-0.207581C3.53394 0.356938 2.87449 0.865764 2.23529 1.30118 1.59103 0.865764 0.998666 0.399973 0.434148-0.0822729 0.331623-0.17214 0.175937-0.159483 0.102525-0.096196Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 633.533 298.512)"/><path d="M0 0C0.492372 0.701218 1.01132 1.25308 1.48091 1.66318 1.92772 2.06695 2.27579 2.35174 2.82766 2.67324 3.09473 2.82766 2.93651 2.60362 2.69982 2.47958 2.31756 2.27579 1.93278 1.98847 1.50749 1.63533 1.06448 1.24042 0.593631 0.736659 0.137965 0.0974617-0.024049-0.129105-0.0860701-0.121511 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 625.454 298.121)"/><path d="M0 0C0.764505 0.230364 2.06568 0.218972 2.06568 0.218972 2.06568 0.218972 3.36306 0.230364 4.13136 0 4.31743-0.0556924 4.2668-0.184798 3.86556-0.0708813 3.0441 0.162014 2.56691 0.116448 2.06568 0.158217 1.56192 0.116448 1.08474 0.162014 0.265805-0.0708813-0.1367-0.184798-0.186063-0.0556924 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 633.699 293.282)"/><path d="M0 0C0.488574-0.579707 1.07081-1.32902 1.45433-1.8581 1.05562-1.89607 0.553127-2.02012-0.00759442-2.25934L0.0936645-2.38338C0.151888-2.46439 0.282259-2.53021 0.378455-2.4897 0.822729-2.30744 1.25561-2.18213 1.66318-2.14669 2.17074-2.85677 2.66058-3.60102 2.92765-3.97315L3.00612-3.97315C3.04536-3.97315 3.0808-3.91872 2.97701-3.7605 2.61754-3.21497 2.24921-2.66817 1.87329-2.1353L1.9062-2.13403C2.27959-2.13403 2.62261-2.19099 2.9441-2.29984 3.02131-2.32389 3.05549-2.30364 3.03397-2.24289L2.9479-2.06315C2.44287-1.86316 2.04163-1.84291 1.79481-1.84291L1.66698-1.84418C1.23536-1.23916 0.754379-0.597428 0.348078-0.130371 0.227833 0.00759442 0.14556 0 0.14556 0Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 643.06 297.389)"/><path d="M0 0C0.61768 0.218972 1.16068 0.322763 1.59103 0.348078 2.15682-0.0936645 2.79981-0.71261 3.29598-1.20878L3.43774-1.20372C3.48457-1.186 3.4871-1.12904 3.39597-1.04044 2.90107-0.544267 2.41376-0.0620211 1.88721 0.353141 2.33022 0.348078 2.75045 0.311371 3.17573 0.208847 3.44534 0.143028 3.46685 0.169609 3.4023 0.217707L3.28459 0.289854C2.87449 0.477183 2.07454 0.579707 1.63407 0.56705L1.61002 0.56705C1.07208 0.964491 0.511358 1.30751-0.0784757 1.58217-0.160749 1.62141-0.315168 1.65052-0.379721 1.64293L-0.474651 1.63533C0.112651 1.37079 0.806274 0.937911 1.32269 0.554393 0.820197 0.520218 0.220238 0.392378-0.502497 0.141763L-0.359469 0.0417693C-0.289854-0.0164546-0.148091-0.0531609 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.056 295.384)"/><path d="M0 0C0.501232 0.440476 1.03284 0.897407 1.57837 1.32396 2.13277 0.746785 2.79475 0.0443008 3.28079-0.473386L3.41243-0.373392C3.47065-0.322763 3.48457-0.225301 3.39724-0.127839 2.98334 0.325294 2.46439 0.903736 1.86443 1.5442 2.35427 1.91506 2.84917 2.26314 3.34534 2.54413 3.45926 2.60995 3.4466 2.72007 3.37699 2.80108L3.23902 2.92765C2.75171 2.65425 2.14416 2.24795 1.58977 1.83405 1.0822 2.36693 0.50756 2.91879-0.0734127 3.49976-0.186063 3.61241-0.306308 3.60229-0.373392 3.5428L-0.50756 3.42635C0.0556924 2.86436 0.682232 2.23909 1.29991 1.61255 0.746785 1.19106 0.091133 0.62654-0.501232 0.102525L-0.364532-0.0417693C-0.289854-0.115182-0.148091-0.131637 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.099 302.975)"/><path d="M0 0C0.48984 0.577176 1.06575 1.32016 1.45053 1.84924 0.951834 1.89228 0.482246 2.05049 0.00632868 2.24162L0.0772099 2.353C0.125308 2.44667 0.269602 2.52514 0.373392 2.48084 0.817666 2.29731 1.25055 2.172 1.65938 2.1353 2.16568 2.84791 2.66438 3.5871 2.93524 3.97188L3.01878 3.95922C3.05296 3.9415 3.05043 3.87189 2.97195 3.75164 2.61248 3.20485 2.24415 2.65931 1.86949 2.12517L1.90114 2.12517C2.27453 2.12517 2.61754 2.18213 2.93904 2.29098 3.02258 2.31883 3.06941 2.29605 3.00739 2.18972L2.88461 2.02012C2.49224 1.88215 2.14796 1.83152 1.78975 1.83152L1.66191 1.83405C1.25561 1.26574 0.837918 0.71261 0.402504 0.184798 0.263273 0.0164546 0.193658-0.0113916 0.124042-0.00886016Z" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 643.065 314.273)"/><path d="M0 0C0.501232-0.440476 1.03284-0.898673 1.57837-1.32396 2.13277-0.746785 2.79475-0.0405036 3.28079 0.477183L3.41369 0.369595C3.47065 0.318966 3.48457 0.22277 3.39724 0.126574 2.98334-0.32656 2.46439-0.905002 1.86443-1.54167 2.35427-1.91379 2.84917-2.26187 3.34534-2.5454 3.46685-2.61375 3.4466-2.72766 3.37445-2.80108L3.22889-2.92891C2.76817-2.66438 2.14416-2.24921 1.58977-1.83405 1.0822-2.36819 0.50756-2.91879-0.0734127-3.49976-0.182266-3.60988-0.298714-3.60355-0.368329-3.54786L-0.50756-3.42255C0.0556924-2.8593 0.755645-2.17327 1.29991-1.61255 0.794883-1.2227 0.091133-0.627805-0.502497-0.105056L-0.378455 0.0265805C-0.30884 0.112651-0.158217 0.139231 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 639.099 308.695)"/><path d="M0 0C-0.493637 0.701218-1.01386 1.25308-1.48218 1.66318-1.92772 2.06695-2.27706 2.35174-2.82766 2.67324-3.09473 2.82766-2.93398 2.60362-2.70108 2.47958-2.31883 2.27579-1.93278 1.98847-1.50749 1.63533-1.06575 1.24042-0.593631 0.736659-0.137965 0.0974617 0.0227833-0.129105 0.0835386-0.121511 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.076 298.121)"/><path d="M0 0C-0.493637-0.699952-1.01386-1.25308-1.48218-1.66318-1.92772-2.06695-2.27706-2.35174-2.82766-2.67324-3.09473-2.82766-2.93398-2.60362-2.70108-2.48084-2.31883-2.27706-1.93278-1.98974-1.50749-1.63533-1.06575-1.24169-0.593631-0.737925-0.137965-0.0987275 0.0227833 0.127839 0.0835386 0.120245 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.076 313.553)"/><path d="M0 0C0.273399-0.477183 0.544267-0.997401 0.799946-1.56572 0.565784-1.23789 0.246819-0.874624-0.0873358-0.679701L-0.0556924-0.761974C-0.0392378-0.808806 0.0848044-0.980946 0.207581-1.07841 0.469588-1.28472 0.71261-1.54673 0.929051-1.8657 1.1822-2.45426 1.41636-3.09093 1.63407-3.77569 1.66824-3.87695 1.6809-3.86936 1.65685-3.77949 1.49104-3.19725 1.29991-2.64412 1.09107-2.12264 1.29738-2.47452 1.48091-2.88588 1.64166-3.36053 1.66444-3.42888 1.67584-3.42888 1.65179-3.36053 1.45939-2.76184 1.23283-2.25048 0.968289-1.82266 0.689827-1.16068 0.378455-0.553127 0.0556924-0.00253147 0.0291119 0.0417693-0.173406 0.306308 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.597 299.065)"/><path d="M0 0C0.273399 0.477183 0.544267 0.996135 0.799946 1.56572 0.565784 1.23916 0.256945 0.879687-0.0873358 0.686029L-0.0632868 0.744253C-0.0405036 0.820197 0.117714 1.00499 0.207581 1.07588 0.469588 1.28346 0.71261 1.54546 0.929051 1.8657 1.1822 2.45426 1.41636 3.09093 1.63407 3.77316 1.66824 3.87695 1.6809 3.86936 1.65685 3.77949 1.49104 3.19725 1.29991 2.64286 1.09107 2.12264 1.29738 2.47325 1.48091 2.88461 1.64166 3.35927 1.66444 3.42761 1.67584 3.43015 1.65179 3.358 1.45939 2.76057 1.23283 2.24921 0.968289 1.82266 0.689827 1.15941 0.378455 0.551861 0.0556924 0.00126574 0.0291119-0.0443008-0.173406-0.307574 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 646.597 312.605)"/><path d="M0 0C-0.767036-0.229098-2.06568-0.220238-2.06568-0.220238-2.06568-0.220238-3.36686-0.229098-4.13136 0-4.31743 0.0556924-4.26806 0.183532-3.86556 0.0696155-3.04536-0.16328-2.56818-0.117714-2.06568-0.159483-1.56318-0.117714-1.08727-0.16328-0.265805 0.0696155 0.135434 0.183532 0.186063 0.0556924 0 0" fill="#647ABB" fill-rule="evenodd" transform="matrix(1 0 0 -1.00833 637.83 318.391)"/><path d="M339.221 422.788C337.033 419.208 341.52 411.469 349.915 406.341L349.915 406.341C358.309 401.212 367.435 400.637 369.622 404.216L369.622 404.216C370.657 405.908 370.076 408.38 368.286 411.057L368.286 411.057C368.251 410.848 368.208 410.639 368.164 410.432L368.164 410.432C370.029 407.308 369.565 405.872 368.843 404.69L368.843 404.69C367.338 402.227 359.25 403.485 351.282 408.353L351.282 408.353C343.316 413.219 338.493 419.85 340 422.314L340 422.314C340.722 423.5 342.454 424.366 345.289 424.221L345.289 424.221C345.493 424.396 345.703 424.564 345.913 424.724L345.913 424.724C345.32 424.793 344.751 424.827 344.212 424.827L344.212 424.827C341.851 424.827 340.063 424.166 339.221 422.788" fill="url(#fill4)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/><path d="M366.288 421.025C369.818 420.136 370.505 418.794 370.827 417.448L370.827 417.448C371.505 414.64 364.895 409.811 355.82 407.619L355.82 407.619C346.747 405.428 338.648 406.704 337.971 409.511L337.971 409.511C337.642 410.864 338.253 412.698 340.363 414.603L340.363 414.603C340.383 414.871 340.411 415.136 340.449 415.401L340.449 415.401C337.928 413.398 336.616 411.225 337.083 409.296L337.083 409.296C338.068 405.221 346.714 402.921 356.276 405.229L356.276 405.229C365.84 407.541 372.699 413.585 371.714 417.663L371.714 417.663C371.247 419.589 369.089 420.927 365.931 421.555L365.931 421.555C366.056 421.381 366.173 421.203 366.288 421.025" fill="url(#fill5)" transform="matrix(1 0 0 -1.00833 281.336 722.192)"/></g></svg>';
                            }
                            ?>

                        </div>
                    </div>

                    <!-- Header center message box -->
                    <div class="col-sm-4 nowarning msgbox text-center text-danger">
                        <?php
                        if (!empty($_POST['usernamefld'])) {
                            print("<h4>" . $_SESSION['Login_Error'] . "</h4>");
                        }
                        ?>
                    </div>

                    <!-- Header right message box (hostname or msg)-->
                    <div class="col-sm-4 nowarning msgbox text-center">
							<span id="hostspan">
								<a><h4><?echo("SynerSAT Web Console");?></h4></a>
							</span>
                    </div>
                </div>
                <?php
                if ($warnclass == "pagebodywarn") {
                    ?>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="alert alert-warning <?=$warnclass?>">
                                <?=gettext("The IP address being used to access this router is not configured locally, which may be forwarded by NAT or other means.
								If this forwarding is unexpected, it should be verified that a man-in-the-middle attack is not taking place.")?>
                            </div>
                        </div>
                    </div>
                    <?php
                }
                ?>
            </div>
        </header>

        <div style="background: <?=$logincssfile?>;" class="<?=$warnclass?>">
            <div class="col-sm-4"></div>

            <div class="col-sm-4 offset-md-4 logoCol">
                <div class="loginCont center-block">
                    <form method="post" <?=$loginautocomplete?> class="login">
                        <p class="form-title">Welcome! <br><?echo $vesselinfo['vesselname'];?></p>
                        <input name="usernamefld" id="usernamefld" type="text" placeholder="Username" autocorrect="off" autocapitalize="none"/>
                        <input name="passwordfld" id="passwordfld" type="password" placeholder="Password" />
                        <input type="submit" name="login" value="Sign In" class="btn btn-success btn-sm" />
                    </form>
                </div>
            </div>
            <?php
                //$printstr = '<p>';
                foreach ($config['system']['vesselinfo'] as $key => $item){
                    $printstr .= '<div class="col-sm-4">'.$key.' : '.$item.'</div>';
                }
                //$printstr = '</p>';
                echo $printstr;

            ?>

        </div>

        <footer id="3">
            <div id="footertext">
                <p class="text-muted">
                    <?=print_credit()?>
                </p>
            </div>
        </footer>
    </div>

    <script type="text/javascript">
        //<![CDATA[
        /* Prevent duplicate submission  */
        events.push(function() {
            var submitted = false;

            $(form).submit(function(e){
                if (submitted) {
                    e.preventDefault();
                } else {
                    submitted = true;
                    // Form is submitted because default action is not prevented
                }
            });
        });
        //]]>
    </script>

    <script src="/vendor/jquery/jquery-3.5.1.min.js?v=<?=filemtime('/usr/local/www/vendor/jquery/jquery-3.5.1.min.js')?>"></script>
    <script src="/vendor/bootstrap/js/bootstrap.min.js?v=<?=filemtime('/usr/local/www/vendor/bootstrap/js/bootstrap.min.js')?>"></script>
    <script src="/js/pfSense.js?v=<?=filemtime('/usr/local/www/js/pfSense.js')?>"></script>

    <script type="text/javascript">
        //!<[CDATA[
        events.push(function() {
            document.cookie=
                "cookie_test=1" +
                "<?php echo $config['system']['webgui']['protocol'] == 'https' ? '; secure' : '';?>";

            if (document.cookie.indexOf("cookie_test") == -1) {
                alert("<?=gettext('The browser must support cookies to login.')?>");
            }

            // Delete it
            document.cookie = "cookie_test=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";
        });
        //]]>
    </script>

    </body>
    </html>

    <?php
} // end function
